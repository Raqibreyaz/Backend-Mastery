import jwt from "jsonwebtoken";

const clientId =
  "233479796620-euvqpn89coqtru5upn67dkg3ba3tq0i0.apps.googleusercontent.com";

const token = `eyJhbGciOiJSUzI1NiIsImtpZCI6ImMyN2JhNDBiMDk1MjlhZDRmMTY4MjJjZTgzMTY3YzFiYzM5MTAxMjIiLCJ0eXAiOiJKV1QifQ.eyJpc3MiOiJodHRwczovL2FjY291bnRzLmdvb2dsZS5jb20iLCJhenAiOiIyMzM0Nzk3OTY2MjAtZXV2cXBuODljb3F0cnU1dXBuNjdka2czYmEzdHEwaTAuYXBwcy5nb29nbGV1c2VyY29udGVudC5jb20iLCJhdWQiOiIyMzM0Nzk3OTY2MjAtZXV2cXBuODljb3F0cnU1dXBuNjdka2czYmEzdHEwaTAuYXBwcy5nb29nbGV1c2VyY29udGVudC5jb20iLCJzdWIiOiIxMDQyMTMxNTk0NDc0MTEzNzQ4NjMiLCJlbWFpbCI6InJvY2tzdGFycmFxdWliQGdtYWlsLmNvbSIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJhdF9oYXNoIjoiSEpJcTdXMFZEb05TNGU4NEJMb3E4USIsIm5hbWUiOiJSb2Nrc3RhciBSYXF1aWIiLCJwaWN0dXJlIjoiaHR0cHM6Ly9saDMuZ29vZ2xldXNlcmNvbnRlbnQuY29tL2EvQUNnOG9jSmVRX0VOMEU0cDFxN09HUFQ0bXVRMldUbmhNT3dZZG5YZG9OSS1FQmlXeEdKUXBBPXM5Ni1jIiwiZ2l2ZW5fbmFtZSI6IlJvY2tzdGFyIiwiZmFtaWx5X25hbWUiOiJSYXF1aWIiLCJpYXQiOjE3NzA5MzAwMDgsImV4cCI6MTc3MDkzMzYwOH0.bXwn1dZc0z2v3RpRvjPSTXpWIaAsWZwyCccRCD5AlDGWkLc6FA2kAo6AjjbTowSigy6eWimiJLYNIlV68cNZhTaIJkTA8LQtorNYnR4_2IAGp5MRxX_Xop6jVoCPv1QlqXMyMzsykd4l-t_BsS8X9Hs0rbiYn98dwB3CoVqgM6vBihrx1yXR4Ex5ifnUb_s4MpT2M30GAiA98gV9p71uFY7UYIpMR_Nxr-_l7kun8AFqOPT4ANWvbRz-zZQ3aZw6WQc37za05kMmPMVjVPzZF7niFzPzhuy-ig-9cmyX51xuUNaJ4O6QkyPYnywINLx9GkjCYjK-XkdJIwk1Eip9QA`;

const publicKey = `-----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAu81qxSoubYoVt+J3VaJX
xgsLQmyAXa9pnkxygDA59Z4WNhsfPfbXHlsAta3a+eikfRgswP+kzIhYoASDjH09
AgpsnCVZXdjRp3VcZpQ7cm0KAmYniknOB3C56t2PuazYhmHjqwjYvuYbfP1lCzJR
LCwsmM5vwJZTWiO/kDqTnPh7z0guZgrFe5xw2syKWxoi4TRXmCwffo+FsukYU4nN
V19wDCccI6/hI2OWPWqG77tLV1RJnr/4xZPQDzk33qMOzCrIi0hlsk0ONs6CkOQ9
YHLW8QXVabjTm6ojUp4cRRhVXUr/9FmrXJrc2Ws2sizhSqjrPzLFZBtKvZqueBmE
YQIDAQAB
-----END PUBLIC KEY-----
`;

const decoded = jwt.verify(token, publicKey, { algorithms: ["RS256"] });

if (decoded.aud === clientId)
  console.log("token was created exclusively for this app!");
